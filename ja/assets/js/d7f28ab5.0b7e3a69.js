"use strict";(globalThis.webpackChunkdeveloper_playcanvas_com=globalThis.webpackChunkdeveloper_playcanvas_com||[]).push([[610],{7184:(e,s,n)=>{n.d(s,{C:()=>A,G:()=>S});var a=n(11470),t=n(19365),r=n(59849),o=n(96540),i=n(95293),l=n(9764),d=n(18676),c=n(58817),h=n(19748),u=n(83395),p=n(43025),g=n(10977),m=n(7306),x=n(68869),f=n(78692),y=n(8939),j=n(40050),v=n(93953),w=n(27351),k=n(74848);const b="// \u2191 imports hidden",S=({code:e,label:s,filename:n,language:i="jsx",showDemo:d=!1,showViewSourceButton:c=!0,showControls:h=!0,children:u})=>{const[p,g]=(0,o.useState)(0);if(!u||!e)return console.error("CodeExample: code and children are required"),null;return(0,k.jsxs)(a.A,{defaultValue:p>0?"Code":d?"Demo":"Code",children:[(0,k.jsx)(t.A,{value:"Demo",children:(0,k.jsxs)("div",{className:"code-example-demo",children:[u,c&&(0,k.jsxs)("div",{className:"code-example-demo-footer",children:[s," - ",(0,k.jsx)("a",{href:"#",onClick:e=>{e.preventDefault(),g(e=>e+1)},children:"View Code"})]}),(0,k.jsx)("div",{className:"code-example-controls",children:(0,k.jsx)(l.XA,{fill:!0,hidden:!1===h})})]})}),(0,k.jsx)(t.A,{value:"Code",children:(0,k.jsx)(r.A,{language:i,title:n,children:e.includes(b)?b+e.split(b)[1]:e})})]},p)},M=e=>{const{width:s=8,depth:n=8,intensity:a=.75}=e,t=(0,o.useMemo)(()=>new v.e(s,1,n),[s,n]);return(0,k.jsxs)(d.w,{children:[(0,k.jsx)(h.v,{type:"directional",castShadows:!0,normalOffsetBias:0,shadowBias:0,shadowDistance:16,shadowResolution:1024,shadowType:w.au1,shadowUpdateMode:w.M5l,vsmBlurSize:8,shadowIntensity:a,intensity:0}),(0,k.jsx)(u.e,{script:y.X,intensity:a,scale:t})]})},A=({children:e,useLight:s=!0,useControls:n=!1,useGrid:a=!1,useShadow:t=!1,camera:r=[0,0,10],sceneOffset:l=[0,-.501,0],exposure:h=1})=>{const{colorMode:y}=(0,i.G)(),v=(0,g.n)(),{asset:w}=(0,m.yj)("/assets/helipad.png"),b="dark"===y?"#2a2a2a":"#e4e0e0",[S,A]=(0,o.useState)(!1),[C,L]=(0,o.useState)(!1),R=(0,o.useCallback)(()=>A(!0),[]),q=(0,o.useCallback)(()=>A(!1),[]),E=(0,o.useCallback)(()=>L(!0),[]),D=(0,o.useCallback)(()=>L(!1),[]);return(0,o.useEffect)(()=>{const e=v.graphicsDevice.canvas;e.style.cursor=S?"grabbing":C?"grab":"default"},[S,C,v]),(0,o.useEffect)(()=>{const e=()=>A(!1);return v.graphicsDevice.canvas.addEventListener("pointerup",e),()=>v.graphicsDevice?.canvas.removeEventListener("pointerup",e)},[v]),(0,k.jsxs)(d.w,{children:[(0,k.jsxs)(d.w,{name:"camera",position:r,children:[(0,k.jsx)(c.i,{clearColor:b,renderSceneColorMap:!0}),n&&(0,k.jsx)(u.e,{script:x.a,enableFly:!1,pitchRange:new j.Z(-90,-5)})]}),s&&(0,k.jsx)(p.O,{envAtlas:w,showSkybox:!1,exposure:h}),a&&(0,k.jsx)(d.w,{name:"grid",scale:[1e3,1,1e3],position:[0,-.5,0],children:(0,k.jsx)(u.e,{script:f.x})}),t&&(0,k.jsx)(d.w,{position:l,children:(0,k.jsx)(M,{})}),(0,k.jsx)(d.w,{onPointerOver:E,onPointerOut:D,onPointerDown:R,onPointerUp:q,children:e})]})}},24421:(e,s,n)=>{n.d(s,{A:()=>h});var a=n(18676),t=n(19748),r=n(83395),o=n(93953),i=n(27351),l=n(8939),d=n(96540),c=n(74848);const h=e=>{const{width:s=2,depth:n=2,intensity:h=.75}=e,u=(0,d.useMemo)(()=>new o.e(s,1,n),[s,n]);return(0,c.jsxs)(a.w,{position:[0,.001,0],children:[(0,c.jsx)(t.v,{type:"directional",castShadows:!0,normalOffsetBias:0,shadowBias:0,shadowDistance:16,shadowResolution:1024,shadowType:i.au1,shadowUpdateMode:i.M5l,vsmBlurSize:8,shadowIntensity:h,intensity:0}),(0,c.jsx)(r.e,{script:l.X,intensity:h,scale:u})]})}},49801:(e,s,n)=>{n.d(s,{A:()=>i});var a=n(18676),t=n(83395),r=n(78692),o=n(74848);const i=({...e})=>(0,o.jsx)(a.w,{scale:[1e3,1,1e3],children:(0,o.jsx)(t.e,{script:r.x,...e})})},53558:(e,s,n)=>{n.d(s,{A:()=>y});var a=n(96540),t=n(68869),r=n(8939),o=n(78692),i=n(14007),l=n(25303),d=n(34363),c=n(53512),h=n(49801),u=n(24421),p=n(85593),g=n(83395),m=n(83171),x=n(74848);const f=e=>(0,x.jsx)(g.e,{script:m.d,...e}),y={React:a,...a,...i,...l,...d,...c,Grid:h.A,ShadowCatcher:u.A,GridScript:o.x,ShadowCatcherScript:r.X,StaticPostEffects:p.A,AutoRotate:f,CameraControls:t.a}},78053:(e,s,n)=>{n.r(s),n.d(s,{assets:()=>m,contentTitle:()=>g,default:()=>y,frontMatter:()=>p,metadata:()=>a,toc:()=>x});const a=JSON.parse('{"id":"user-manual/playcanvas-react/guide/loading-assets","title":"Loading Assets","description":"Whether its textures, materials or 3D models, assets are a key part of any 3D app. And generally speaking, they take the most time to load. PlayCanvas React provides a set of specialized hooks for loading different types of assets, as well as a utility function for loading assets. This helps you get up to speed quickly but with granular control of how and when assets are loaded.","source":"@site/docs/user-manual/playcanvas-react/guide/loading-assets.mdx","sourceDirName":"user-manual/playcanvas-react/guide","slug":"/user-manual/playcanvas-react/guide/loading-assets","permalink":"/ja/user-manual/playcanvas-react/guide/loading-assets","draft":false,"unlisted":false,"editUrl":"https://github.com/playcanvas/developer.playcanvas.com/tree/dev/docs/user-manual/playcanvas-react/guide/loading-assets.mdx","tags":[],"version":"current","frontMatter":{"title":"Loading Assets"},"sidebar":"userManualSidebar","previous":{"title":"Interactivity","permalink":"/ja/user-manual/playcanvas-react/guide/interactivity"},"next":{"title":"Physics","permalink":"/ja/user-manual/playcanvas-react/guide/physics"}}');var t=n(74848),r=n(28453),o=n(7184),i=n(78264),l=n(18676),d=n(16230),c=n(7306);const h=()=>{const{asset:e,error:s}=(0,c.fn)("/assets/statue.glb");return s?(console.error("Error loading model:",s),null):e?(0,t.jsx)(l.w,{position:[0,-.5,0],scale:[.1,.1,.1],children:(0,t.jsx)(d.d,{asset:e})}):null},u="import { Entity } from '@playcanvas/react';\nimport { Render } from '@playcanvas/react/components';\nimport { useModel } from '@playcanvas/react/hooks';\n\nexport const ModelLoading = () => {\n  // Load the selected model\n  const { asset, error } = useModel('/assets/statue.glb');\n\n  // If there is an error, log it\n  if (error) {\n    console.error('Error loading model:', error);\n    return null;\n  }\n\n  // If the asset is not loaded, return null\n  if (!asset) return null;\n\n  // If the asset is loaded, render it\n  return (\n    <Entity position={[0, -0.5, 0]} scale={[0.1, 0.1, 0.1]}>\n      <Render asset={asset} />\n    </Entity>\n  );\n};\n\n",p={title:"Loading Assets"},g=void 0,m={},x=[{value:"Basic Usage",id:"basic-usage",level:2},{value:"Preloading",id:"preloading",level:2},{value:"Loading with Props",id:"loading-with-props",level:2},{value:"Asset hooks",id:"asset-hooks",level:2},{value:"Asset Caching",id:"asset-caching",level:3},{value:"Custom Loading States",id:"custom-loading-states",level:3},{value:"Progressive Loading",id:"progressive-loading",level:3},{value:"Data Fetching Libraries",id:"data-fetching-libraries",level:3},{value:"Suspense Integration",id:"suspense-integration",level:3}];function f(e){const s={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(s.p,{children:"Whether its textures, materials or 3D models, assets are a key part of any 3D app. And generally speaking, they take the most time to load. PlayCanvas React provides a set of specialized hooks for loading different types of assets, as well as a utility function for loading assets. This helps you get up to speed quickly but with granular control of how and when assets are loaded."}),"\n",(0,t.jsx)(s.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,t.jsxs)(s.p,{children:["The simplest way to load an asset is to use one of the specialized hooks. There are special hooks for ",(0,t.jsx)(s.a,{href:"../../api/hooks/use-asset#usemodel",children:"models"}),", ",(0,t.jsx)(s.a,{href:"../../api/hooks/use-asset#usesplat",children:"gaussian splats"}),", ",(0,t.jsx)(s.a,{href:"../../api/hooks/use-asset#usetexture",children:"textures"}),", ",(0,t.jsx)(s.a,{href:"../../api/hooks/use-asset#useenvatlas",children:"environment map"}),", ",(0,t.jsx)(s.a,{href:"../../api/hooks/use-asset#usefont",children:"fonts"})," and more. They all have a similar shape and return a PlayCanvas ",(0,t.jsx)(s.a,{href:"https://api.playcanvas.com/engine/classes/Asset.html",children:(0,t.jsx)(s.code,{children:"Asset"})}),"."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-tsx",children:"const { asset } = useModel('model.glb');\nreturn <Render asset={asset} />;\n"})}),"\n",(0,t.jsxs)(s.p,{children:["In this example, we're loading a model using the ",(0,t.jsx)(s.a,{href:"../../api/hooks/use-asset#usemodel",children:(0,t.jsx)(s.code,{children:"useModel"})})," hook and rendering it using the ",(0,t.jsx)(s.a,{href:"../../api/render",children:(0,t.jsx)(s.code,{children:"<Render/>"})})," component."]}),"\n",(0,t.jsx)(o.G,{label:"Loading a model with useModel",code:u,showDemo:!0,children:(0,t.jsx)(i.l,{children:(0,t.jsx)(o.C,{useLight:!0,useShadow:!0,useGrid:!0,camera:[2,1,2],useControls:!0,exposure:3,children:(0,t.jsx)(h,{})})})}),"\n",(0,t.jsx)(s.h2,{id:"preloading",children:"Preloading"}),"\n",(0,t.jsx)(s.p,{children:"The asset hooks also return additional loading info and error states, so you can fallback to a preloader while loading or display an error message if the asset fails to load."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-tsx",metastring:'title="model-viewer.tsx"',children:"import { useModel } from '@playcanvas/react/hooks';\n\nexport function ModelViewer() {\n  const { asset, loading, error } = useModel('model.glb');\n\n  // If the asset is still loading, show a loading spinner\n  if (loading) return <LoadingSpinner />;\n\n  // If there is an error, show an error message\n  if (error) return <ErrorMessage message={error} />;\n\n  // If the asset is loaded, render it\n  return <Render type=\"asset\" asset={asset} />;\n}\n"})}),"\n",(0,t.jsx)(s.h2,{id:"loading-with-props",children:"Loading with Props"}),"\n",(0,t.jsx)(s.p,{children:"Some assets accept additional properties to customize how they are loaded. You can pass these properties to the hook as a second argument."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-tsx",children:"// Load a texture with specific settings\nconst { asset } = useTexture('texture.jpg', {\n    mipmaps: true,\n    anisotropy: 16,\n    type: 'rgba'\n});\n"})}),"\n",(0,t.jsx)(s.h2,{id:"asset-hooks",children:"Asset hooks"}),"\n",(0,t.jsxs)(s.p,{children:["There are different hooks for loading different types of assets. You can create more advanced hooks by wrapping the ",(0,t.jsx)(s.code,{children:"useAsset"})," hook."]}),"\n",(0,t.jsxs)(s.ul,{children:["\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"../../api/hooks/use-asset#usemodel",children:(0,t.jsx)(s.code,{children:"useModel"})})," for loading 3D GLTF/GLB models"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"../../api/hooks/use-asset#usetexture",children:(0,t.jsx)(s.code,{children:"useTexture"})})," for loading textures"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"../../api/hooks/use-asset#usesplat",children:(0,t.jsx)(s.code,{children:"useSplat"})})," for loading Gaussian Splats"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"../../api/hooks/use-asset#useenvatlas",children:(0,t.jsx)(s.code,{children:"useEnvAtlas"})})," for loading environment atlases"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"../../api/hooks/use-asset#useasset",children:(0,t.jsx)(s.code,{children:"useAsset"})})," for loading any type of asset"]}),"\n",(0,t.jsxs)(s.li,{children:[(0,t.jsx)(s.a,{href:"../../api/hooks/use-asset#usefont",children:(0,t.jsx)(s.code,{children:"useFont"})})," for loading fonts"]}),"\n"]}),"\n",(0,t.jsx)(s.h3,{id:"asset-caching",children:"Asset Caching"}),"\n",(0,t.jsx)(s.p,{children:"Assets are cached by default to avoid reloading the same file multiple times. This means you're not duplicating on memory, but you'll need to ensure assets are correctly unloaded when they're no longer needed."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-tsx",metastring:'title="unloading-model-viewer.tsx"',children:"import { useModel } from '@playcanvas/react/hooks';\nimport { useEffect } from 'react';\n\nexport function UnloadingModelViewer() {\n  const { asset, loading, error } = useModel('model.glb');\n\n  useEffect(() => {\n    return () => asset?.unload();\n  }, [asset]);\n\n  if (!asset) return null;\n\n  return <Render type=\"asset\" asset={asset} />;\n}\n"})}),"\n",(0,t.jsx)(s.admonition,{type:"warning",children:(0,t.jsxs)(s.p,{children:[(0,t.jsx)(s.strong,{children:"Unloading an asset will remove it globally."})," This will affect other components that are using the same asset."]})}),"\n",(0,t.jsx)(s.h3,{id:"custom-loading-states",children:"Custom Loading States"}),"\n",(0,t.jsx)(s.p,{children:"You can use placeholders or custom loaders while assets load by checking the loading state of an asset. This gives you granular control."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-tsx",metastring:'title="loading-spinner.tsx"',children:"import { Entity, Render } from '@playcanvas/react/components';\n\n// A component that displays a model with a custom loading state\nexport function ModelWithCustomLoading() {\n  const { asset: plane, loading: planeLoading } = useModel('plane.glb');\n  const { asset: car, loading: carLoading } = useModel('car.glb');\n    \n  if (planeLoading || carLoading) return <LoadingSpinner />;\n\n  return <>\n    <Entity name=\"car\">\n      <Render asset={car} />\n    </Entity>\n    <Entity name=\"plane\">\n      <Render asset={plane} />\n    </Entity>\n  </>\n}\n"})}),"\n",(0,t.jsx)(s.h3,{id:"progressive-loading",children:"Progressive Loading"}),"\n",(0,t.jsx)(s.p,{children:"The loading hooks also provide a simple mechanic to progressively load assets, so you can prioritize rendering quickly following up with high quality content later."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-tsx",metastring:'title="progressive-loading.tsx"',children:"import { Entity, Render } from '@playcanvas/react/components';\n\n// A component that displays a model with a custom loading state\nexport function ProgressiveAsset() {\n  const { asset: low } = useModel('./low-quality-model.sog'); // load the low quality asset\n  const { asset: high } = useModel(low && './high-quality-model.sog'); // load the high quality asset, when the low quality is loaded\n  \n  if (!low && !high ) return null;\n\n  return <Gsplat asset={high || low} />\n}\n"})}),"\n",(0,t.jsx)(s.h3,{id:"data-fetching-libraries",children:"Data Fetching Libraries"}),"\n",(0,t.jsxs)(s.p,{children:["If you need more advanced caching or loading strategies, you can integrate with libraries like ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.a,{href:"https://tanstack.com/query/latest",children:"React Query"})})," or ",(0,t.jsx)(s.strong,{children:(0,t.jsx)(s.a,{href:"https://swr.vercel.app/",children:"SWR"})})," or any other Promise based library using the ",(0,t.jsx)(s.code,{children:"fetchAsset"})," utility."]}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-tsx",metastring:'title="model-with-query.tsx"',children:"import { fetchAsset } from '@playcanvas/react/utils';\nimport { useQuery } from '@tanstack/react-query';\n\nfunction useQueryModel(src: string) {\n  const query = useQuery({\n    queryKey: ['asset', src],\n    // 'container' is the type of asset we're loading (e.g., model, texture, etc.)\n    queryFn: () => fetchAsset({ app, url: src, type: 'container' })\n  });\n\n  return query;\n}\n\nexport function ModelWithQuery() {\n  const { data: asset, isLoading } = useQueryModel('model.glb');\n\n  if (isLoading) return <LoadingSpinner />;\n  return <Render type=\"asset\" asset={asset} />;\n}\n"})}),"\n",(0,t.jsxs)(s.p,{children:["See the ",(0,t.jsx)(s.a,{href:"https://tanstack.com/query/latest",children:"React Query documentation"})," and ",(0,t.jsx)(s.a,{href:"https://swr.vercel.app/",children:"SWR documentation"})," for more information on how to use it."]}),"\n",(0,t.jsx)(s.h3,{id:"suspense-integration",children:"Suspense Integration"}),"\n",(0,t.jsx)(s.p,{children:"React Query and SWR have built-in support for Suspense, which allows you to handle loading states in a more declarative way."}),"\n",(0,t.jsx)(s.pre,{children:(0,t.jsx)(s.code,{className:"language-tsx",children:"import { fetchAsset } from '@playcanvas/react/utils';\nimport { useQuery } from '@tanstack/react-query';\n\nfunction useSuspendedQueryModel(src: string) {\n  const query = useQuery({\n    queryKey: ['asset', src],\n    queryFn: () => fetchAsset({ app, url: src, type: 'container' }),\n    suspense: true\n  });\n\n  return query;\n}\n\nexport function ModelWithQuery() {\n  const { data: asset } = useSuspendedQueryModel('model.glb');\n  return <Render type=\"asset\" asset={asset} />;\n}\n"})}),"\n",(0,t.jsxs)(s.p,{children:["You can read more about Suspense in the ",(0,t.jsx)(s.a,{href:"https://react.dev/reference/react/Suspense",children:"React documentation"}),", as well as the ",(0,t.jsx)(s.a,{href:"https://tanstack.com/query/v4/docs/framework/react/guides/suspense",children:"React Query documentation"})," and ",(0,t.jsx)(s.a,{href:"https://swr.vercel.app/docs/suspense",children:"SWR documentation"}),"."]})]})}function y(e={}){const{wrapper:s}={...(0,r.R)(),...e.components};return s?(0,t.jsx)(s,{...e,children:(0,t.jsx)(f,{...e})}):f(e)}},85593:(e,s,n)=>{n.d(s,{A:()=>o});var a=n(83395),t=n(15817),r=n(74848);const o=e=>{const s={lighting:{exposure:1.21,skyBoxIntensity:1.02},rendering:{renderFormat:18,renderTargetScale:1,sharpness:0,samples:4,toneMapping:4,fog:"none",fogColor:{r:0,g:0,b:0,a:1},fogRange:[0,100],fogDensity:.01,renderFormatFallback0:12,renderFormatFallback1:14,sceneColorMap:!1,sceneDepthMap:!1,fogStart:0,fogEnd:100},bloom:{enabled:!0,intensity:.1,lastMipLevel:1},grading:{enabled:!0,brightness:.83,contrast:1.1,saturation:1.2,tint:{r:1,g:.9333333333333333,b:.8666666666666667,a:1}},vignette:{enabled:!0,intensity:1,inner:.25,outer:1.52,curvature:.78},fringing:{enabled:!0,intensity:10},...e};return(0,r.jsx)(a.e,{script:t.P,...s})}}}]);