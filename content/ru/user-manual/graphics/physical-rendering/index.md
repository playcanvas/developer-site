---
title: Физически основанный рендеринг
layout: usermanual-page.hbs
position: 3
---

![Star-Lord][1]
*Модель Star-Lord от [Joachim Coppens][2]*

Физически основанный рендеринг (PBR) - это сочетание рабочего процесса художника, измеренных физических свойств и шейдеров материалов, которые вместе придают порядок и согласованность графическому рендерингу. Используя основные физические принципы взаимодействия света и поверхностей, мы можем создавать предсказуемые визуальные образы, которые работают при всех условиях освещения без специальных случаев.

# Основные принципы

Ниже мы попытаемся кратко изложить основные принципы, на которых основаны физически основанные шейдеры при расчете освещения. В следующих разделах мы подробнее рассмотрим особенности использования физически основанного рендеринга в PlayCanvas.

## Диффузное и зеркальное отражение

Диффузное и зеркальное (или отраженное) световые потоки - это два термина, которые описывают два основных типа взаимодействия между светом и материалом. Зеркальное отражение относится к свету, который отразился от поверхности. На гладкой поверхности этот свет будет отражаться в одном направлении, и поверхность будет выглядеть зеркальной. Диффузное световое излучение - это свет, который был поглощен, рассеян в материале и снова вышел наружу. Этот свет, в отличие от зеркального, имеет равномерное направление. Во время поглощения и повторного выхода некоторые длины волн света будут поглощены. Длины волн, которые не поглощаются, придают материалу его цвет. Например, если все синие и зеленые длины волн поглощены, материал будет красным. В терминах рендеринга диффузный цвет иногда называется "альбедо" или "основным цветом".

## Сохранение энергии

![Сохранение энергии][3]
*Гладкие поверхности имеют маленькие яркие участки, шероховатые поверхности имеют большие тусклые участки*

Одна из ключевых особенностей физически корректного рендеринга - это сохранение энергии. Исходя из того, что диффузное световое излучение и отраженное световое излучение происходят от света, попадающего на материал, сумма диффузного и отраженного света не может быть больше общего количества света, попадающего на материал. На практике это означает, что если поверхность сильно отражает свет, она будет показывать очень мало диффузного цвета. И наоборот, если материал имеет яркий диффузный цвет, он не может сильно отражать свет.

Радость PBR заключается в том, что сохранение энергии включено в шейдер, поэтому вам, как художнику, не нужно думать об этом. Это просто работает!

## Металлы и неметаллы

![Металлы и неметаллы][4]

Одно из новых свойств PBR по сравнению со старыми моделями затенения - это определение материала, из которого сделан объект, чтобы определить его поведение. Главное, что мы здесь рассматриваем, - это является ли материал проводником (обычно металлом) или изолятором (неметаллом).

Это важно, потому что определяет множество факторов, влияющих на то, как материал реагирует на свет. Например, металлы обычно отражают свет (от 60% до 90%), в то время как неметаллы - нет (от 0% до 20%). Во-вторых, отражения на неметаллах обычно белые, в то время как металлы обычно отражают тот же цвет, что и диффузный.

Из-за этих различий один из рабочих процессов PBR включает свойство **металличности**, которое упрощает определение материала как металла или неметалла. Более подробно о рабочем процессе металличности в следующих разделах.

## Френель

Френель - это термин, который вам не обязательно знать, чтобы работать с PBR в PlayCanvas, но если вы его знаете, у вас будет лучше представление о поведении материалов.

Все, что вам нужно знать о Френеле, - это то, что угол, под которым вы смотрите на поверхность, влияет на то, насколько отражательной кажется эта поверхность. Если поверхность почти перпендикулярна вашему взгляду, она будет почти полностью отражающей.

## Микроповерхность

Наконец, перейдем к микроповерхности. В целом, 3D-художники знакомы с идеей карт нормалей. Текстуры, которые изменяют направление поверхности, к которой они применяются. Микроповерхность, также известная как шероховатость или глянцевость, предоставляет нечто подобное, только в меньшем масштабе. Микроповерхность материала описывает, насколько шероховатой или гладкой является поверхность. Сравните стекло (высокая глянцевость, низкая шероховатость) с наждачной бумагой (высокая шероховатость, низкая глянцевость). Мы не указываем точное направление поверхности, просто общую идею о шероховатости или гладкости.

Некоторые PBR-системы используют шероховатость (Roughness), другие - глянцевость (Glossiness), но это одно и то же. Шероховатость является обратной величиной глянцевости и наоборот. Если вы хотите преобразовать одно значение в другое, просто инвертируйте текстуру или значение.

[Далее: Физические материалы][6]

*Больше информации можно найти в отличной статье Marmoset Toolbag's [PBR Theory][5].*

[1]: /images/user-manual/graphics/physical-rendering/star-lord.jpg
[2]: https://www.joachimcoppens.com/
[3]: /images/user-manual/graphics/physical-rendering/energy-conservation.jpg
[4]: /images/user-manual/graphics/physical-rendering/materials.jpg
[5]: https://www.marmoset.co/toolbag/learn/pbr-theory
[6]: /user-manual/graphics/physical-rendering/physical-materials
