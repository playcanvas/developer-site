"use strict";(self.webpackChunkdeveloper_playcanvas_com=self.webpackChunkdeveloper_playcanvas_com||[]).push([[90160],{11470:(e,n,t)=>{t.d(n,{A:()=>j});var a=t(96540),o=t(34164),i=t(23104),s=t(56347),r=t(205),c=t(57485),l=t(31682),p=t(70679);function u(e){return a.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function d(e){const{values:n,children:t}=e;return(0,a.useMemo)((()=>{const e=n??function(e){return u(e).map((({props:{value:e,label:n,attributes:t,default:a}})=>({value:e,label:n,attributes:t,default:a})))}(t);return function(e){const n=(0,l.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function h({value:e,tabValues:n}){return n.some((n=>n.value===e))}function m({queryString:e=!1,groupId:n}){const t=(0,s.W6)(),o=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(o),(0,a.useCallback)((e=>{if(!o)return;const n=new URLSearchParams(t.location.search);n.set(o,e),t.replace({...t.location,search:n.toString()})}),[o,t])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:o}=e,i=d(e),[s,c]=(0,a.useState)((()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!h({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find((e=>e.default))??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:i}))),[l,u]=m({queryString:t,groupId:o}),[f,g]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,o]=(0,p.Dv)(n);return[t,(0,a.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:o}),b=(()=>{const e=l??f;return h({value:e,tabValues:i})?e:null})();(0,r.A)((()=>{b&&c(b)}),[b]);return{selectedValue:s,selectValue:(0,a.useCallback)((e=>{if(!h({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);c(e),u(e),g(e)}),[u,g,i]),tabValues:i}}var g=t(92303);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var y=t(74848);function w({className:e,block:n,selectedValue:t,selectValue:a,tabValues:s}){const r=[],{blockElementScrollPositionUntilNextRender:c}=(0,i.a_)(),l=e=>{const n=e.currentTarget,o=r.indexOf(n),i=s[o].value;i!==t&&(c(n),a(i))},p=e=>{let n=null;switch(e.key){case"Enter":l(e);break;case"ArrowRight":{const t=r.indexOf(e.currentTarget)+1;n=r[t]??r[0];break}case"ArrowLeft":{const t=r.indexOf(e.currentTarget)-1;n=r[t]??r[r.length-1];break}}n?.focus()};return(0,y.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":n},e),children:s.map((({value:e,label:n,attributes:a})=>(0,y.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{r.push(e)},onKeyDown:p,onClick:l,...a,className:(0,o.A)("tabs__item",b.tabItem,a?.className,{"tabs__item--active":t===e}),children:n??e},e)))})}function v({lazy:e,children:n,selectedValue:t}){const i=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=i.find((e=>e.props.value===t));return e?(0,a.cloneElement)(e,{className:(0,o.A)("margin-top--md",e.props.className)}):null}return(0,y.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==t})))})}function x(e){const n=f(e);return(0,y.jsxs)("div",{className:(0,o.A)("tabs-container",b.tabList),children:[(0,y.jsx)(w,{...n,...e}),(0,y.jsx)(v,{...n,...e})]})}function j(e){const n=(0,g.A)();return(0,y.jsx)(x,{...e,children:u(e.children)},String(n))}},19365:(e,n,t)=>{t.d(n,{A:()=>s});t(96540);var a=t(34164);const o={tabItem:"tabItem_Ymn6"};var i=t(74848);function s({children:e,hidden:n,className:t}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,a.A)(o.tabItem,t),hidden:n,children:e})}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>r});var a=t(96540);const o={},i=a.createContext(o);function s(e){const n=a.useContext(i);return a.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),a.createElement(i.Provider,{value:n},e.children)}},51415:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>p,contentTitle:()=>l,default:()=>h,frontMatter:()=>c,metadata:()=>a,toc:()=>u});const a=JSON.parse('{"id":"user-manual/editor/publishing/web/communicating-webpage","title":"Communication with web pages","description":"One the key advantages of using PlayCanvas and WebGL over other plugins or cross-compiled engines is the ability to interact directly between your application and the surrounding webpage. In this page we\'ll talk about some common ways of interfacing your PlayCanvas application with a web page or web application.","source":"@site/docs/user-manual/editor/publishing/web/communicating-webpage.md","sourceDirName":"user-manual/editor/publishing/web","slug":"/user-manual/editor/publishing/web/communicating-webpage","permalink":"/user-manual/editor/publishing/web/communicating-webpage","draft":false,"unlisted":false,"editUrl":"https://github.com/playcanvas/developer.playcanvas.com/tree/dev/docs/user-manual/editor/publishing/web/communicating-webpage.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Communication with web pages","sidebar_position":4},"sidebar":"userManualSidebar","previous":{"title":"Self-hosting for beginners","permalink":"/user-manual/editor/publishing/web/self-hosting-for-beginners"},"next":{"title":"Hosting using a CDN","permalink":"/user-manual/editor/publishing/web/hosting-cdn"}}');var o=t(74848),i=t(28453),s=t(11470),r=t(19365);const c={title:"Communication with web pages",sidebar_position:4},l=void 0,p={},u=[{value:"Defining an API",id:"defining-an-api",level:2},{value:"Embedded in IFrame",id:"embedded-in-iframe",level:3},{value:"Serve your own HTML",id:"serve-your-own-html",level:3}];function d(e){const n={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.p,{children:"One the key advantages of using PlayCanvas and WebGL over other plugins or cross-compiled engines is the ability to interact directly between your application and the surrounding webpage. In this page we'll talk about some common ways of interfacing your PlayCanvas application with a web page or web application."}),"\n",(0,o.jsx)(n.p,{children:"There are two ways you may find your PlayCanvas application communicating with the surrounding Web page. First, you may have embedded your application in a iframe in a page. Second you may be serving your own HTML page which loads an PlayCanvas page. These two methods require very different ways of communicating between web page and application."}),"\n",(0,o.jsx)(n.h2,{id:"defining-an-api",children:"Defining an API"}),"\n",(0,o.jsx)(n.p,{children:"Common to both methods of hosting you should think about what features of your PlayCanvas application you need to expose to the web page. Perhaps you need to change the color of something based on a button click or a slider; or you might need to send some text input into the application to be rendered to a texture. Decide in advance what features you need to expose and in your PlayCanvas application write an explicit API or set of functions which are the only functions that your web page will call."}),"\n",(0,o.jsx)(n.p,{children:"Here is a simple example where we show a couple of different ways of exposing an API from a PlayCanvas application to a web page."}),"\n","\n",(0,o.jsxs)(s.A,{defaultValue:"classic",groupId:"script-code",children:[(0,o.jsx)(r.A,{value:"esm",label:"ESM",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:'import { Script, Application } from \'playcanvas\';\n\n// Define a global function to set the score\nwindow.setScore = function(score) {\n    const app = Application.getApplication();\n    const entity = app.root.findByName("Score Keeper");\n    if (entity && entity.script && entity.script.scoreKeeper) {\n        entity.script.scoreKeeper.setScore(score);\n    }\n};\n\nexport class ScoreKeeper extends Script {\n    static scriptName = "scoreKeeper";\n\n    initialize() {\n        // Define an application event to set the score\n        this.app.on("score:set", (score) => {\n            this.setScore(score);\n        }, this);\n    }\n\n    setScore(score) {\n        // Do the score setting here.\n    }\n}\n\n// How to use the API:\n\n// Method one:\nwindow.setScore(10);\n\n// Method two:\nconst app = Application.getApplication();\napp.fire("score:set", 10);\n'})})}),(0,o.jsx)(r.A,{value:"classic",label:"Classic",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:'// method one: define a global function to set the score\nwindow.setScore = function (score) {\n    const app = pc.Application.getApplication();\n    const entity = app.root.findByName("Score Keeper");\n    entity.script.scoreKeeper.setScore(score);\n}\n\nvar ScoreKeeper = pc.createScript("scoreKeeper");\n\nScoreKeeper.prototype.initialize = function (entity) {\n    // method two: define an application event to set the score\n    this.app.on("score:set", function (score) {\n        this.setScore(score);\n    }, this);\n};\n\nScoreKeeper.prototype.setScore = function (score) {\n    // do the score setting here.\n};\n\n// how to use the API:\n\n// method one:\nwindow.setScore(10);\n\n// method two:\nconst app = pc.Application.getApplication();\napp.fire("score:set", 10);\n'})})})]}),"\n",(0,o.jsx)(n.p,{children:"Method one defines a global function which can be called anywhere in your page to access your application. Method two defines an application event which you can fire from your page. The application listens for this event and performs actions in response to the event. Both are valid methods of defining an API with your application."}),"\n",(0,o.jsx)(n.h3,{id:"embedded-in-iframe",children:"Embedded in IFrame"}),"\n",(0,o.jsx)(n.p,{children:"Embedding a PlayCanvas application in an iframe is a quick and easy way to get your PlayCanvas content in a page. It also means that you can make use of our optimized hosting and don't need to worry about serving all the PlayCanvas content. However, the downside is that you can not call javascript functions in the PlayCanvas application directly from the hosting page because they are running on different pages."}),"\n",(0,o.jsxs)(n.p,{children:["To communicate between a parent page and an iframe you will need to use the ",(0,o.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage",children:"postMessage"})," javascript API to send data between your page and the PlayCanvas application."]}),"\n",(0,o.jsxs)(n.p,{children:["In your host page, use the iframeless URL for the iframe. The default publish link has the build in an iframe to include the social sharing bar at the bottom. This can cause problems with ",(0,o.jsx)(n.a,{href:"https://developer.mozilla.org/en-US/docs/Web/API/Window/postMessage",children:"postMessage"})," as there are now two iframes to communicate through."]}),"\n",(0,o.jsxs)(n.p,{children:["If you add ",(0,o.jsx)(n.code,{children:"/e"})," after ",(0,o.jsx)(n.code,{children:"https://playcanv.as"})," in the URL, this will give you a version of the build without the iframe and social sharing bar."]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",children:'<iframe id="app-frame" src="https://playcanv.as/e/p/example/">\n<script>\nconst iframe = document.getElementById("app-frame");\niframe.contentWindow.postMessage({\n    score: 10,\n}, "https://playcanv.as");\n<\/script>\n'})}),"\n",(0,o.jsx)(n.p,{children:"In your application"}),"\n",(0,o.jsxs)(s.A,{defaultValue:"classic",groupId:"script-code",children:[(0,o.jsx)(r.A,{value:"esm",label:"ESM",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:'import { Application } from \'playcanvas\';\n\nwindow.addEventListener("message", (event) => {\n    if (event.origin === "http://example.com") { // always check message came from your website\n        const score = event.data.score;\n\n        // call API method one:\n        window.setScore(score);\n\n        // call API method two:\n        const app = Application.getApplication();\n        app.fire("score:set", score);\n    }\n}, false);\n'})})}),(0,o.jsx)(r.A,{value:"classic",label:"Classic",children:(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-javascript",children:'window.addEventListener("message", function (event) {\n    if (event.origin === "http://example.com") { // always check message came from your website\n        const score = event.data.score;\n\n        // call API method one:\n        window.setScore(score);\n\n        // call API method two:\n        const app = pc.Application.getApplication();\n        app.fire("score:set", score);\n    }\n}, false);\n'})})})]}),"\n",(0,o.jsx)(n.h3,{id:"serve-your-own-html",children:"Serve your own HTML"}),"\n",(0,o.jsx)(n.p,{children:"When you download your PlayCanvas application for self-hosting. This is the index.html page that we include to run your application."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",children:'<!doctype html>\n<html>\n<head>\n    <meta name=\'viewport\' content=\'width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no\'>\n    <meta charset=\'utf-8\'>\n    <link rel="stylesheet" type="text/css" href="styles.css">\n    <title>Application Title</title>\n    <script src="playcanvas-stable.min.js"><\/script>\n    <script>\n        SCENE_PATH = "12346.json";\n        CONTEXT_OPTIONS = {\n            \'alpha\': false,\n            \'preserveDrawingBuffer\': false\n        };\n    <\/script>\n</head>\n<body>\n    <script src="__start__.js"><\/script>\n    <script src="__loading__.js"><\/script>\n</body>\n</html>\n'})}),"\n",(0,o.jsx)(n.p,{children:"It is absolutely possible and even recommended, that you modify start from this page as the basis of your web page and you can modify it to add any additional content that is required for you page."}),"\n",(0,o.jsxs)(n.p,{children:["When it comes to communicating with your PlayCanvas application, for example from a button push. You can call the APIs we defined above directly from your script. There is no need for the ",(0,o.jsx)(n.code,{children:"postMessage"})," calls."]}),"\n",(0,o.jsxs)(n.p,{children:["Note, it is important that you run any custom code after the ",(0,o.jsx)(n.code,{children:"__start__.js"})," scripts as this creates the PlayCanvas application. In many cases you may wish to wait until after all the asset loading has finished, but before the application starts. You can do this by responding to the ",(0,o.jsx)(n.code,{children:"start"})," event."]}),"\n",(0,o.jsx)(n.p,{children:"For example:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-html",children:'<!doctype html>\n<html>\n<head>\n    <meta name=\'viewport\' content=\'width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no\'>\n    <meta charset=\'utf-8\'>\n    <link rel="stylesheet" type="text/css" href="styles.css">\n    <title>Application Title</title>\n    <script src="playcanvas-stable.min.js"><\/script>\n    <script>\n        SCENE_PATH = "12346.json";\n        CONTEXT_OPTIONS = {\n            \'alpha\': false,\n            \'preserveDrawingBuffer\': false\n        };\n    <\/script>\n</head>\n<body>\n    <script src="__start__.js"><\/script>\n    <script src="__loading__.js"><\/script>\n    <script>\n    const app = pc.Application.getApplication();\n    app.on("start", function () {\n        // get the root of the scene.\n        const hierarchy = app.root.children[0];\n\n        // do other stuff here\n    });\n    <\/script>\n</body>\n</html>\n'})})]})}function h(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(d,{...e})}):d(e)}}}]);