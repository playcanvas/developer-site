"use strict";(self.webpackChunkdeveloper_playcanvas_com=self.webpackChunkdeveloper_playcanvas_com||[]).push([[58674],{11470:(e,n,t)=>{t.d(n,{A:()=>A});var a=t(96540),i=t(34164),o=t(17559),s=t(23104),r=t(56347),l=t(205),c=t(57485),u=t(31682),d=t(70679);function m(e){return a.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,a.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function h(e){const{values:n,children:t}=e;return(0,a.useMemo)(()=>{const e=n??function(e){return m(e).map(({props:{value:e,label:n,attributes:t,default:a}})=>({value:e,label:n,attributes:t,default:a}))}(t);return function(e){const n=(0,u.XI)(e,(e,n)=>e.value===n.value);if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[n,t])}function p({value:e,tabValues:n}){return n.some(n=>n.value===e)}function f({queryString:e=!1,groupId:n}){const t=(0,r.W6)(),i=function({queryString:e=!1,groupId:n}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:e,groupId:n});return[(0,c.aZ)(i),(0,a.useCallback)(e=>{if(!i)return;const n=new URLSearchParams(t.location.search);n.set(i,e),t.replace({...t.location,search:n.toString()})},[i,t])]}function b(e){const{defaultValue:n,queryString:t=!1,groupId:i}=e,o=h(e),[s,r]=(0,a.useState)(()=>function({defaultValue:e,tabValues:n}){if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!p({value:e,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${n.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const t=n.find(e=>e.default)??n[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:o})),[c,u]=f({queryString:t,groupId:i}),[m,b]=function({groupId:e}){const n=function(e){return e?`docusaurus.tab.${e}`:null}(e),[t,i]=(0,d.Dv)(n);return[t,(0,a.useCallback)(e=>{n&&i.set(e)},[n,i])]}({groupId:i}),g=(()=>{const e=c??m;return p({value:e,tabValues:o})?e:null})();(0,l.A)(()=>{g&&r(g)},[g]);return{selectedValue:s,selectValue:(0,a.useCallback)(e=>{if(!p({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);r(e),u(e),b(e)},[u,b,o]),tabValues:o}}var g=t(92303);const y={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var v=t(74848);function x({className:e,block:n,selectedValue:t,selectValue:a,tabValues:o}){const r=[],{blockElementScrollPositionUntilNextRender:l}=(0,s.a_)(),c=e=>{const n=e.currentTarget,i=r.indexOf(n),s=o[i].value;s!==t&&(l(n),a(s))},u=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const t=r.indexOf(e.currentTarget)+1;n=r[t]??r[0];break}case"ArrowLeft":{const t=r.indexOf(e.currentTarget)-1;n=r[t]??r[r.length-1];break}}n?.focus()};return(0,v.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,i.A)("tabs",{"tabs--block":n},e),children:o.map(({value:e,label:n,attributes:a})=>(0,v.jsx)("li",{role:"tab",tabIndex:t===e?0:-1,"aria-selected":t===e,ref:e=>{r.push(e)},onKeyDown:u,onClick:c,...a,className:(0,i.A)("tabs__item",y.tabItem,a?.className,{"tabs__item--active":t===e}),children:n??e},e))})}function j({lazy:e,children:n,selectedValue:t}){const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(e){const e=o.find(e=>e.props.value===t);return e?(0,a.cloneElement)(e,{className:(0,i.A)("margin-top--md",e.props.className)}):null}return(0,v.jsx)("div",{className:"margin-top--md",children:o.map((e,n)=>(0,a.cloneElement)(e,{key:n,hidden:e.props.value!==t}))})}function w(e){const n=b(e);return(0,v.jsxs)("div",{className:(0,i.A)(o.G.tabs.container,"tabs-container",y.tabList),children:[(0,v.jsx)(x,{...n,...e}),(0,v.jsx)(j,{...n,...e})]})}function A(e){const n=(0,g.A)();return(0,v.jsx)(w,{...e,children:m(e.children)},String(n))}},19365:(e,n,t)=>{t.d(n,{A:()=>s});t(96540);var a=t(34164);const i={tabItem:"tabItem_Ymn6"};var o=t(74848);function s({children:e,hidden:n,className:t}){return(0,o.jsx)("div",{role:"tabpanel",className:(0,a.A)(i.tabItem,t),hidden:n,children:e})}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>r});var a=t(96540);const i={},o=a.createContext(i);function s(e){const n=a.useContext(o);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),a.createElement(o.Provider,{value:n},e.children)}},41013:(e,n,t)=>{t.d(n,{A:()=>a});const a=t.p+"assets/images/animation_blending-be54796750003ff5963bdc9415646c9f.jpg"},69050:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>a,toc:()=>d});const a=JSON.parse('{"id":"tutorials/animation-blending","title":"Animation Blending","description":"This tutorial uses the deprecated Model and Animation components. Please refer to the Anim State Graph Blending tutorial instead.","source":"@site/docs/tutorials/animation-blending.md","sourceDirName":"tutorials","slug":"/tutorials/animation-blending","permalink":"/tutorials/animation-blending","draft":false,"unlisted":false,"editUrl":"https://github.com/playcanvas/developer.playcanvas.com/tree/dev/docs/tutorials/animation-blending.md","tags":[{"inline":true,"label":"animation","permalink":"/tags/animation"}],"version":"current","frontMatter":{"title":"Animation Blending","tags":["animation"],"thumb":"https://s3-eu-west-1.amazonaws.com/images.playcanvas.com/projects/12/405874/A8B1FE-image-75.jpg"},"sidebar":"tutorialsSidebar","previous":{"title":"Animated Textures","permalink":"/tutorials/animated-textures"},"next":{"title":"Animation without State Graph","permalink":"/tutorials/animation-without-state-graph"}}');var i=t(74848),o=t(28453),s=t(11470),r=t(19365);const l={title:"Animation Blending",tags:["animation"],thumb:"https://s3-eu-west-1.amazonaws.com/images.playcanvas.com/projects/12/405874/A8B1FE-image-75.jpg"},c=void 0,u={},d=[{value:"The Animation Component",id:"the-animation-component",level:2}];function m(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.admonition,{type:"warning",children:(0,i.jsxs)(n.p,{children:["This tutorial uses the deprecated Model and Animation components. Please refer to the ",(0,i.jsx)(n.a,{href:"/tutorials/anim-blending/",children:"Anim State Graph Blending tutorial"})," instead."]})}),"\n",(0,i.jsx)("div",{className:"iframe-container",children:(0,i.jsx)("iframe",{src:"https://playcanv.as/p/HI8kniOx/",title:"Animation Blending",allow:"camera; microphone; xr-spatial-tracking; fullscreen",allowfullscreen:!0})}),"\n",(0,i.jsx)(n.admonition,{type:"info",children:(0,i.jsx)(n.p,{children:"Click on screen to focus, then press the 'p' key to blend to a punch animation."})}),"\n",(0,i.jsx)(n.p,{children:"This tutorial illustrates the basics of animation blending."}),"\n",(0,i.jsx)(n.p,{children:"Objects in your scene may be animated; machines or characters are good examples of things that you might want to animate. Generally, when 3D content is created, individual animations are authored and these animations are typically referred to as cycles (because they loop). For example, a human character could have an idle cycle, a walk cycle, a run cycle and so on. As a PlayCanvas developer, you'll want a mechanism to play these animations back on your animated object. Additionally, you do not want these animations to 'pop' as one is switched for another. To remedy this, you should use animation blending which implements a smooth transition from one animation to another. This dramatically improves the visual fidelity of your animated object."}),"\n",(0,i.jsx)(n.p,{children:"Let's examine how this is achieved via PlayCanvas..."}),"\n",(0,i.jsx)(n.h2,{id:"the-animation-component",children:"The Animation Component"}),"\n",(0,i.jsx)(n.p,{children:"In order to apply an animation to a model, you add the animation component to your entity. Below is the configuration of the skinned character as displayed in PlayCanvas Editor."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{alt:"Animated Entity",src:t(41013).A+"",width:"314",height:"748"})}),"\n",(0,i.jsx)(n.p,{children:"In the image you can see the animation component in the Inspector. There are 2 animation assets assigned: an 'idle' cycle and a 'punch' cycle. With the animation component configured this way, the behavior is that the first animation (the idle cycle) is played and because the looping option is set, it will continue to animate ad infinitum. However, we would like to achieve something a little more interesting:"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Play a looping idle animation."}),"\n",(0,i.jsx)(n.li,{children:"Blend to a looping punch animation on a key press."}),"\n",(0,i.jsx)(n.li,{children:"Blend back to idle on key release."}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"So this kind of functionality goes beyond the abilities of the humble animation component. A script component is required to cook up this additional behavior. You can see the script component in the above screenshot of the skinned character entity in Editor and it refers to a JS file called animation_blending.js. The contents of this file is:"}),"\n","\n",(0,i.jsxs)(s.A,{defaultValue:"classic",groupId:"script-code",children:[(0,i.jsx)(r.A,{value:"esm",label:"ESM",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"import { Script, KEY_P } from 'playcanvas';\n\nexport class AnimationBlending extends Script {\n    static scriptName = 'animationBlending';\n\n    static states = {\n        idle: {\n            animation: 'male.json'\n        },\n        punch: {\n            animation: 'male_uppercut_jab.json'\n        }\n    }\n\n    // initialize code called once per entity\n    initialize() {\n        this.blendTime = 0.2;\n\n        this.setState('idle');\n    };\n\n    update(dt) {\n        if (this.app.keyboard.wasPressed(KEY_P)) {\n            this.setState('punch');\n        }\n\n        if (this.app.keyboard.wasReleased(KEY_P)) {\n            this.setState('idle');\n        }\n    };\n\n    setState(state) {\n        const states = AnimationBlending.states;\n\n        this.state = state;\n        // Set the current animation, taking 0.2 seconds to blend from\n        // the current animation state to the start of the target animation.\n        this.entity.animation.play(states[state].animation, this.blendTime);\n    };\n}\n"})})}),(0,i.jsx)(r.A,{value:"classic",label:"Classic",children:(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-javascript",children:"var AnimationBlending = pc.createScript('animationBlending');\n\nAnimationBlending.states = {\n    idle: {\n        animation: 'male.json'\n    },\n    punch: {\n        animation: 'male_uppercut_jab.json'\n    }\n};\n\n// initialize code called once per entity\nAnimationBlending.prototype.initialize = function() {\n    this.blendTime = 0.2;\n\n    this.setState('idle');\n};\n\nAnimationBlending.prototype.update = function(dt) {\n    if (this.app.keyboard.wasPressed(pc.KEY_P)) {\n        this.setState('punch');\n    }\n\n    if (this.app.keyboard.wasReleased(pc.KEY_P)) {\n        this.setState('idle');\n    }\n};\n\nAnimationBlending.prototype.setState = function (state) {\n    var states = AnimationBlending.states;\n\n    this.state = state;\n    // Set the current animation, taking 0.2 seconds to blend from\n    // the current animation state to the start of the target animation.\n    this.entity.animation.play(states[state].animation, this.blendTime);\n};\n"})})})]}),"\n",(0,i.jsx)(n.p,{children:"From this point, you are able to add more and more animations to the animation component and start scripting much more complex animation state charts."}),"\n",(0,i.jsxs)(n.p,{children:["See ",(0,i.jsx)(n.a,{href:"https://playcanvas.com/editor/scene/440156",children:"the full Scene here"})]})]})}function h(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(m,{...e})}):m(e)}}}]);